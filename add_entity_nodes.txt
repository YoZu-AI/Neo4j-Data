LOAD CSV WITH HEADERS FROM 'file:///Class_6_Science_NCERT\data.csv' AS row
WITH row WHERE NOT row.entity_1_type IS NULL AND NOT row.entity_2_type IS NULL
// Filter out rows with null values in entity_1_type or entity_2_type

MERGE (sentence:Sentence {text: row.sentence})
MERGE (entity1:Entity {text: row.entity_1, type: row.entity_1_type})
MERGE (entity2:Entity {text: row.entity_2, type: row.entity_2_type})

MERGE (sentence)-[:has_entity]->(entity1)
MERGE (sentence)-[:has_entity]->(entity2)

MERGE (entity1)-[:relation]->(entity2)

FOREACH (r IN CASE WHEN NOT row.relation IS NULL THEN [1] ELSE [] END |
  MERGE (relation:Relation {text: row.relation})
  MERGE (entity1)-[:relation]->(relation)
  MERGE (entity2)-[:relation]->(relation)
)
